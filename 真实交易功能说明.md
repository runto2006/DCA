# 真实交易功能使用说明

## 🚀 功能概述

本系统现已支持币安真实交易功能，允许用户通过Web界面直接进行SOL/USDT和BTC/USDT的真实交易。

## ⚠️ 重要风险提示

**这是真实交易功能，将使用您的币安账户进行实际交易，请务必谨慎操作！**

- 所有交易都是真实的，会实际影响您的账户余额
- 加密货币市场波动剧烈，存在亏损风险
- 请确保您了解交易风险，并仔细核对交易信息
- 建议先使用小额资金测试交易功能

## 🔐 API密钥配置

### 1. 创建币安API密钥

1. 登录币安账户
2. 进入"API管理"页面
3. 点击"创建API"
4. 设置API密钥名称（如：SOLBTC-DCA-System）

### 2. 配置API权限

**必需权限：**
- ✅ 读取权限（查看账户信息、余额等）

**真实交易权限：**
- ✅ 交易权限（执行买入/卖出操作）

**安全设置：**
- 🔒 IP白名单（建议设置，限制访问IP）
- 🔒 启用交易密码（额外安全验证）

### 3. 环境变量配置

在 `.env.local` 文件中添加：

```env
# 币安API配置
BINANCE_API_KEY=your_binance_api_key
BINANCE_API_SECRET=your_binance_api_secret
```

## 🧪 功能测试

### 运行测试脚本

```bash
node test-real-trading.js
```

测试脚本将检查：
- API密钥配置
- 交易权限
- 账户余额
- 价格获取
- API权限详情

### 测试结果解读

**✅ 所有测试通过：**
- 真实交易功能已准备就绪
- 可以在Web界面中使用交易面板

**❌ 部分测试失败：**
- 检查API密钥配置
- 确认API权限设置
- 验证网络连接

## 💻 Web界面使用

### 1. 访问真实交易面板

在系统主页面的"真实交易面板"区域：
- 查看交易权限状态
- 检查账户余额
- 查看当前价格

### 2. 执行交易

1. **点击"开始交易"按钮**
2. **选择交易参数：**
   - 交易对：SOL/USDT 或 BTC/USDT
   - 交易方向：买入 或 卖出
   - 数量：输入交易数量
   - 价格：可选，留空为市价单
   - 交易原因：可选说明

3. **确认交易信息：**
   - 仔细核对交易预览
   - 确认交易金额
   - 检查交易方向

4. **执行交易：**
   - 点击"确认买入"或"确认卖出"
   - 等待交易执行结果
   - 查看交易详情

### 3. 交易结果

**成功交易：**
- 显示订单ID
- 实际成交价格和数量
- 交易状态和时间

**失败交易：**
- 显示错误信息
- 失败原因说明
- 建议解决方案

## 📊 交易类型

### 市价单（Market Order）
- 以当前市场价格立即成交
- 成交价格可能略有偏差
- 适合快速交易

### 限价单（Limit Order）
- 指定价格进行交易
- 可能不会立即成交
- 适合精确控制价格

## 🔍 余额检查

系统会自动检查：
- **买入时：** USDT余额是否足够
- **卖出时：** 对应币种余额是否足够
- **实时更新：** 交易后自动刷新余额

## 🛡️ 安全措施

### 内置安全检查
- 交易权限验证
- 余额充足性检查
- 交易参数验证
- 错误处理和提示

### 用户安全建议
- 使用强密码保护API密钥
- 定期更换API密钥
- 设置IP白名单
- 启用交易密码
- 小额测试后再大额交易

## 📈 交易记录

所有真实交易都会：
- 记录在币安账户中
- 可在币安交易历史中查看
- 系统会显示交易结果

## 🔧 故障排除

### 常见问题

**1. "交易功能未启用"**
- 检查API密钥配置
- 确认API具有交易权限
- 验证IP地址在白名单中

**2. "余额不足"**
- 检查账户余额
- 确认币种正确
- 考虑交易手续费

**3. "交易执行失败"**
- 检查网络连接
- 确认交易参数正确
- 查看错误详情

**4. "API请求失败"**
- 检查API密钥有效性
- 确认API权限设置
- 验证时间戳同步

### 错误代码说明

- **-2015**: API密钥无效或权限不足
- **-2010**: 余额不足
- **-2011**: 交易对不存在
- **-2013**: 无效的交易参数

## 📞 技术支持

如遇到问题：
1. 查看错误信息和日志
2. 运行测试脚本诊断
3. 检查币安API文档
4. 联系技术支持

## 📝 更新日志

### v1.0.0 (当前版本)
- ✅ 添加真实交易功能
- ✅ 支持SOL/USDT和BTC/USDT交易
- ✅ 市价单和限价单支持
- ✅ 实时余额检查
- ✅ 交易权限验证
- ✅ 完整的错误处理
- ✅ 用户友好的界面

---

**最后提醒：加密货币交易存在风险，请谨慎投资，量力而行！** 
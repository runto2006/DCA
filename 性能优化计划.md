# SOLBTC-DCAç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–è®¡åˆ’

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

### 1. APIå“åº”æ—¶é—´ä¼˜åŒ–
- **ç›®æ ‡**: å¹³å‡å“åº”æ—¶é—´ < 500ms
- **å½“å‰çŠ¶æ€**: å¹³å‡å“åº”æ—¶é—´ < 1ç§’
- **ä¼˜åŒ–æªæ–½**:
  - å®ç°Redisç¼“å­˜å±‚
  - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
  - æ·»åŠ APIå“åº”ç¼“å­˜
  - å®ç°æ•°æ®é¢„åŠ è½½

### 2. é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„
- **ç›®æ ‡**: é”™è¯¯å¤„ç†è¦†ç›–ç‡ > 95%
- **å½“å‰çŠ¶æ€**: åŸºç¡€é”™è¯¯å¤„ç†
- **ä¼˜åŒ–æªæ–½**:
  - ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
  - å®Œå–„APIé”™è¯¯å“åº”æ ¼å¼
  - æ·»åŠ ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
  - å®ç°é”™è¯¯æ—¥å¿—è®°å½•

### 3. æ•°æ®ç¼“å­˜ç­–ç•¥
- **ç›®æ ‡**: ç¼“å­˜å‘½ä¸­ç‡ > 80%
- **å½“å‰çŠ¶æ€**: æ— ç¼“å­˜æœºåˆ¶
- **ä¼˜åŒ–æªæ–½**:
  - ä»·æ ¼æ•°æ®ç¼“å­˜ï¼ˆ30ç§’ï¼‰
  - ç­–ç•¥æ•°æ®ç¼“å­˜ï¼ˆ5åˆ†é’Ÿï¼‰
  - å¸ç§åˆ—è¡¨ç¼“å­˜ï¼ˆ1å°æ—¶ï¼‰
  - æ™ºèƒ½ç¼“å­˜å¤±æ•ˆç­–ç•¥

## ğŸ“‹ å…·ä½“å®æ–½è®¡åˆ’

### é˜¶æ®µ1: ç¼“å­˜å±‚å®ç° (1-2å¤©)
1. **Redisé›†æˆ**
   ```typescript
   // æ·»åŠ Rediså®¢æˆ·ç«¯
   import Redis from 'ioredis'
   const redis = new Redis(process.env.REDIS_URL)
   ```

2. **ä»·æ ¼æ•°æ®ç¼“å­˜**
   ```typescript
   // ç¼“å­˜ä»·æ ¼æ•°æ®30ç§’
   const cacheKey = `price:${symbol}`
   const cached = await redis.get(cacheKey)
   if (cached) return JSON.parse(cached)
   ```

3. **ç­–ç•¥æ•°æ®ç¼“å­˜**
   ```typescript
   // ç¼“å­˜ç­–ç•¥æ•°æ®5åˆ†é’Ÿ
   const cacheKey = `strategy:${symbol}`
   await redis.setex(cacheKey, 300, JSON.stringify(data))
   ```

### é˜¶æ®µ2: æ•°æ®åº“ä¼˜åŒ– (2-3å¤©)
1. **æŸ¥è¯¢ä¼˜åŒ–**
   - æ·»åŠ æ•°æ®åº“ç´¢å¼•
   - ä¼˜åŒ–å¤æ‚æŸ¥è¯¢
   - å®ç°åˆ†é¡µæŸ¥è¯¢

2. **è¿æ¥æ± ä¼˜åŒ–**
   - è°ƒæ•´è¿æ¥æ± å¤§å°
   - å®ç°è¿æ¥å¤ç”¨
   - æ·»åŠ è¿æ¥ç›‘æ§

### é˜¶æ®µ3: APIä¼˜åŒ– (1-2å¤©)
1. **å“åº”æ ¼å¼ç»Ÿä¸€**
   ```typescript
   // ç»Ÿä¸€APIå“åº”æ ¼å¼
   interface ApiResponse<T> {
     success: boolean
     data?: T
     error?: string
     timestamp: string
   }
   ```

2. **é”™è¯¯å¤„ç†ä¸­é—´ä»¶**
   ```typescript
   // ç»Ÿä¸€é”™è¯¯å¤„ç†
   export function handleApiError(error: any) {
     return NextResponse.json({
       success: false,
       error: error.message || 'æœªçŸ¥é”™è¯¯',
       timestamp: new Date().toISOString()
     }, { status: 500 })
   }
   ```

### é˜¶æ®µ4: å‰ç«¯ä¼˜åŒ– (1-2å¤©)
1. **æ•°æ®é¢„åŠ è½½**
   - å®ç°æ•°æ®é¢„å–
   - æ·»åŠ åŠ è½½çŠ¶æ€
   - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

2. **çŠ¶æ€ç®¡ç†ä¼˜åŒ–**
   - å®ç°çŠ¶æ€ç¼“å­˜
   - ä¼˜åŒ–é‡æ¸²æŸ“
   - æ·»åŠ æ€§èƒ½ç›‘æ§

## ğŸ“Š é¢„æœŸæ•ˆæœ

### æ€§èƒ½æå‡
- **APIå“åº”æ—¶é—´**: å‡å°‘50% (ä»1ç§’åˆ°500ms)
- **é¡µé¢åŠ è½½æ—¶é—´**: å‡å°‘30% (ä»3ç§’åˆ°2ç§’)
- **ç¼“å­˜å‘½ä¸­ç‡**: è¾¾åˆ°80%ä»¥ä¸Š
- **é”™è¯¯ç‡**: é™ä½åˆ°1%ä»¥ä¸‹

### ç”¨æˆ·ä½“éªŒæ”¹å–„
- **å“åº”é€Ÿåº¦**: æ›´å¿«çš„æ“ä½œå“åº”
- **ç¨³å®šæ€§**: æ›´å°‘çš„é”™è¯¯å’Œå¼‚å¸¸
- **æµç•…æ€§**: æ›´æµç•…çš„å¸ç§åˆ‡æ¢
- **å¯é æ€§**: æ›´å¯é çš„æ•°æ®æ˜¾ç¤º

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. Redisç¼“å­˜é…ç½®
```typescript
// lib/redis.ts
import Redis from 'ioredis'

const redis = new Redis({
  host: process.env.REDIS_HOST || 'localhost',
  port: parseInt(process.env.REDIS_PORT || '6379'),
  password: process.env.REDIS_PASSWORD,
  retryDelayOnFailover: 100,
  maxRetriesPerRequest: 3
})

export default redis
```

### 2. ç¼“å­˜å·¥å…·å‡½æ•°
```typescript
// lib/cache.ts
import redis from './redis'

export async function getCached<T>(key: string): Promise<T | null> {
  try {
    const cached = await redis.get(key)
    return cached ? JSON.parse(cached) : null
  } catch (error) {
    console.warn('ç¼“å­˜è¯»å–å¤±è´¥:', error)
    return null
  }
}

export async function setCached(key: string, data: any, ttl: number = 300) {
  try {
    await redis.setex(key, ttl, JSON.stringify(data))
  } catch (error) {
    console.warn('ç¼“å­˜å†™å…¥å¤±è´¥:', error)
  }
}
```

### 3. APIç¼“å­˜è£…é¥°å™¨
```typescript
// lib/api-cache.ts
import { getCached, setCached } from './cache'

export function withCache(ttl: number = 300) {
  return function (target: any, propertyName: string, descriptor: PropertyDescriptor) {
    const method = descriptor.value
    
    descriptor.value = async function (...args: any[]) {
      const cacheKey = `${propertyName}:${JSON.stringify(args)}`
      const cached = await getCached(cacheKey)
      
      if (cached) {
        return cached
      }
      
      const result = await method.apply(this, args)
      await setCached(cacheKey, result, ttl)
      return result
    }
  }
}
```

## ğŸ“ˆ ç›‘æ§å’Œè¯„ä¼°

### 1. æ€§èƒ½ç›‘æ§
- APIå“åº”æ—¶é—´ç›‘æ§
- ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡
- é”™è¯¯ç‡ç»Ÿè®¡
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

### 2. è¯„ä¼°æŒ‡æ ‡
- **æŠ€æœ¯æŒ‡æ ‡**: å“åº”æ—¶é—´ã€ç¼“å­˜å‘½ä¸­ç‡ã€é”™è¯¯ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: ç”¨æˆ·æ»¡æ„åº¦ã€æ“ä½œæˆåŠŸç‡
- **ç³»ç»ŸæŒ‡æ ‡**: CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ã€ç½‘ç»œå»¶è¿Ÿ

## ğŸš€ å®æ–½æ—¶é—´è¡¨

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | è´Ÿè´£äºº |
|------|------|----------|--------|
| 1 | Redisé›†æˆå’ŒåŸºç¡€ç¼“å­˜ | 1-2å¤© | å¼€å‘å›¢é˜Ÿ |
| 2 | æ•°æ®åº“ä¼˜åŒ– | 2-3å¤© | å¼€å‘å›¢é˜Ÿ |
| 3 | APIä¼˜åŒ– | 1-2å¤© | å¼€å‘å›¢é˜Ÿ |
| 4 | å‰ç«¯ä¼˜åŒ– | 1-2å¤© | å¼€å‘å›¢é˜Ÿ |
| 5 | æµ‹è¯•å’Œè°ƒä¼˜ | 1å¤© | æµ‹è¯•å›¢é˜Ÿ |

**æ€»è®¡**: 6-10å¤©

## ğŸ’¡ é£é™©æ§åˆ¶

### 1. æŠ€æœ¯é£é™©
- **RedisæœåŠ¡ä¸å¯ç”¨**: å®ç°é™çº§æœºåˆ¶
- **ç¼“å­˜æ•°æ®ä¸ä¸€è‡´**: å®ç°ç¼“å­˜å¤±æ•ˆç­–ç•¥
- **æ€§èƒ½åé™**: é€æ­¥å®æ–½ï¼Œç›‘æ§æ•ˆæœ

### 2. ä¸šåŠ¡é£é™©
- **ç”¨æˆ·ä½“éªŒä¸‹é™**: å……åˆ†æµ‹è¯•ï¼Œé€æ­¥å‘å¸ƒ
- **æ•°æ®å‡†ç¡®æ€§**: ä¿æŒæ•°æ®æºå¯é æ€§
- **ç³»ç»Ÿç¨³å®šæ€§**: æ·»åŠ ç›‘æ§å’Œå‘Šè­¦

## ğŸ“ æ€»ç»“

é€šè¿‡å®æ–½è¿™ä¸ªæ€§èƒ½ä¼˜åŒ–è®¡åˆ’ï¼Œé¢„æœŸèƒ½å¤Ÿï¼š
1. æ˜¾è‘—æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦
2. æ”¹å–„ç”¨æˆ·ä½“éªŒ
3. æé«˜ç³»ç»Ÿç¨³å®šæ€§
4. ä¸ºåç»­åŠŸèƒ½æ‰©å±•å¥ å®šåŸºç¡€

å»ºè®®æŒ‰ç…§ä¼˜å…ˆçº§é€æ­¥å®æ–½ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„æˆæœå’ŒéªŒè¯ã€‚ 